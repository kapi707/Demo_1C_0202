&НаСервере
Функция РассчитатьНаСервере(
	ТипПродукции,
	ТипМатериала,
	ТребуемоеКоличествоПродукции,
	КоличествоПродукцииНаСкладе,
	Параметр1,
	Параметр2)

	// Проверка существования объектов
	Если ТипПродукции = Неопределено Или ТипМатериала = Неопределено Тогда
		Возврат -1;
	КонецЕсли;

	// Проверка корректности числовых параметров
	Если НЕ ЗначениеЗаполнено(ТребуемоеКоличествоПродукции)
		ИЛИ НЕ ЗначениеЗаполнено(Параметр1)
		ИЛИ НЕ ЗначениеЗаполнено(Параметр2)
		ИЛИ ТребуемоеКоличествоПродукции < 0
		ИЛИ Параметр1 <= 0
		ИЛИ Параметр2 <= 0 Тогда
		Возврат -1;
	КонецЕсли;

	Попытка
		Коэффициент = ПолучитьКоэффициент(ТипПродукции);
		ПроцентБрака = ПолучитьПроцентБрака(ТипМатериала);
	Исключение
		Возврат -1;
	КонецПопытки;

	Если Коэффициент = Неопределено Или ПроцентБрака = Неопределено Тогда
		Возврат -1;
	КонецЕсли;                   
	
    // Количество материала на одну штуку продукции
	КоличествоНаЕд = Параметр1 * Параметр2 * Коэффициент;  
	
	// Учитываем брак 
	КоличествоСБраком = КоличествоНаЕд * (1 + ПроцентБрака);
	
    // Необходимое количество продукции к выпуску
	НеобходимоВыпустить = ТребуемоеКоличествоПродукции - КоличествоПродукцииНаСкладе;

	Если НеобходимоВыпустить <= 0 Тогда
		Возврат 0;
	КонецЕсли;

	Возврат Окр(КоличествоСБраком * НеобходимоВыпустить, 0, 1);

КонецФункции
